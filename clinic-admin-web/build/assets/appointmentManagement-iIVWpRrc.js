import{r as s,h as R,j as t}from"./index-CcQ31UA2.js";import{G as V}from"./appointmentAPI-D2AChQuS.js";import{C as h}from"./CFormCheck-CHOFD2Bs.js";import{a as T}from"./index.esm-DMOZoxqD.js";import{C as E,a as L,b as g,c as i,d as M,e as l}from"./CTable-CJv6Qvvu.js";import{j as z}from"./DefaultLayout-Db1AUjSf.js";import"./CFormLabel-LtYOgfC7.js";import"./CConditionalPortal-DQP_4tIk.js";const ne=()=>{const[G,_]=s.useState(null),[U,k]=s.useState([]),[q,w]=s.useState([]),[m,I]=s.useState([]),[J,N]=s.useState([]),[K,A]=s.useState([]),[u,x]=s.useState([]),[c,j]=s.useState([]),[a,C]=s.useState([]),[p,v]=s.useState(1),[D,S]=s.useState(!0),b=7,P=R(),$=async()=>{try{const e=localStorage.getItem("HospitalId");if(console.log("Hospital ID from localStorage:",e),!e){x([]),S(!1);return}const n=await V(e);console.log("Appointments for this Hospital:",n),n!=null&&n.data?x(n.data):(console.warn("No data returned for Hospital ID:",e),x([]))}catch(e){console.error("Failed to fetch appointments:",e),x([])}finally{S(!1)}},B=e=>{switch(console.log(e),e==null?void 0:e.toLowerCase()){case"completed":return"success";case"Rejected":return"danger";case"pending":return"warning";case"confirmed":return"info";case"in progress":return"primary";case"rescheduled":return"secondary";default:return"dark"}};s.useEffect(()=>{$()},[]),s.useEffect(()=>{let e=[...u];console.log("Initial bookings:",e);const n=o=>o==null?void 0:o.toLowerCase().trim(),r={"Service & Treatment":"services & treatments","Video Consultation":"video consultation","In-clinic":"in-clinic consultation"};if(a.length>0&&(e=e.filter(o=>a.some(d=>n(d)===n(o.status))),console.log("After status filter:",e)),c.length===1){const o=c[0];if(o==="Video Consultation")e=e.filter(d=>n(d.consultationType)==="video consultation"||n(d.consultationType)==="online consultation"),console.log(`After ${o} filter:`,e);else{const d=r[o];d&&(e=e.filter(H=>n(H.consultationType)===d),console.log(`After ${o} filter:`,e))}}I(e),v(1)},[u,c,a]),s.useEffect(()=>{const e=[...new Set(u.map(r=>r.subServiceName).filter(Boolean))],n=[...new Set(u.map(r=>r.consultationType).filter(Boolean))];N(e),A(n),console.log("Available Consultation Types:",n)},[u]),s.useEffect(()=>{window.scrollTo(0,0)},[p]);const F=m.slice((p-1)*b,p*b),y=e=>{c.includes(e)?j([]):j([e])},f=e=>{const n=e.target.value;a.includes(n)?C([]):C([n])};return t.jsx("div",{style:{overflow:"hidden"},children:t.jsxs("div",{className:"container mt-4",children:[t.jsx("h5",{children:"Appointments"}),t.jsxs("div",{className:"d-flex gap-2 mb-3",children:[t.jsx("button",{onClick:()=>y("Service & Treatment"),className:`btn ${c.includes("Service & Treatment")?"btn-dark":"btn-outline-dark"}`,children:"Service & Treatment"}),t.jsx("button",{onClick:()=>y("In-clinic"),className:`btn ${c.includes("In-clinic")?"btn-dark":"btn-outline-dark"}`,children:"In-Clinic Consultation"}),t.jsx("button",{onClick:()=>y("Video Consultation"),className:`btn ${c.includes("Video Consultation")?"btn-dark":"btn-outline-dark"}`,children:"Video Consultation"})]}),t.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-center flex-wrap gap-2",children:[t.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[t.jsx(h,{label:"Pending",value:"Pending",onChange:f,checked:a.includes("Pending")}),t.jsx(h,{label:"In-Progress",value:"In-Progress",onChange:f,checked:a.includes("In-Progress")}),t.jsx(h,{label:"Completed",value:"Completed",onChange:f,checked:a.includes("Completed")}),t.jsx(h,{label:"Confirmed",value:"Confirmed",onChange:f,checked:a.includes("Confirmed")}),t.jsx(h,{label:"Rejected",value:"Rejected",onChange:f,checked:a.includes("Rejected")})]}),t.jsx(T,{color:"secondary",onClick:()=>{k([]),w([]),j([]),C([])},children:"Reset Filters"})]}),t.jsxs(E,{striped:!0,hover:!0,responsive:!0,children:[t.jsx(L,{children:t.jsxs(g,{children:[t.jsx(i,{children:"S.No"}),t.jsx(i,{children:"H_ID"}),t.jsx(i,{children:"Name"}),t.jsx(i,{children:"Service Name"}),t.jsx(i,{children:"Consultation Type"}),t.jsx(i,{children:"Date"}),t.jsx(i,{children:"Time"}),t.jsx(i,{children:"Status"}),t.jsx(i,{children:"Action"})]})}),t.jsx(M,{children:D?t.jsx(g,{children:t.jsx(l,{colSpan:"9",className:"text-center text-primary fw-bold",children:"Loading appointments..."})}):Array.isArray(m)&&m.length>0?F.map((e,n)=>{var r;return t.jsxs(g,{children:[t.jsx(l,{children:n+1}),t.jsx(l,{children:e.clinicId}),t.jsx(l,{children:e.name}),t.jsx(l,{children:e.subServiceName}),t.jsx(l,{children:e.consultationType}),t.jsxs(l,{children:[e.sele?`${e.sele} `:"",e.serviceDate]}),t.jsx(l,{children:e.slot||e.servicetime}),t.jsx(l,{children:t.jsx(z,{color:B(e.status),children:(r=e.status)==null?void 0:r.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")})}),t.jsx(l,{children:t.jsx(T,{color:"primary",size:"sm",onClick:()=>P(`/appointmentDetails/${e.bookingId}`,{state:{appointment:e}}),children:"View"})})]},`${e.id}-${n}`)}):t.jsx(g,{children:t.jsx(l,{colSpan:"9",className:"text-center text-danger fw-bold",children:"No appointments found."})})})]}),t.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:Array.from({length:Math.ceil(m.length/b)},(e,n)=>t.jsx("button",{onClick:()=>v(n+1),style:{margin:"0 5px",padding:"5px 10px",backgroundColor:p===n+1?"#007bff":"#fff",color:p===n+1?"#fff":"#000",border:"1px solid #ccc",borderRadius:"5px"},children:n+1},n))})]})})};export{ne as default};
