import{r as t,j as s,o as $,B as k}from"./index-CcQ31UA2.js";import{b as m,c as u}from"./index-CrnPcN9h.js";import{a as A,C as B}from"./CCardBody-BG4Ko6Cs.js";import{C as U}from"./CForm-BLq4MfsE.js";import{C as w}from"./CFormLabel-LtYOgfC7.js";import{C as p}from"./CInputGroup-CeQY4StZ.js";import{C as h}from"./CFormInput-BS0KPjD4.js";import{C as x}from"./CInputGroupText-tgqD37tD.js";import{a as I}from"./index.esm-DMOZoxqD.js";const _=({onClose:j})=>{const[r,P]=t.useState({currentPassword:"",newPassword:"",confirmPassword:"",username:""}),[y,e]=t.useState(""),[b,g]=t.useState(!1),[o,v]=t.useState(!1),[f,N]=t.useState(!1),[C,S]=t.useState(!1),c=n=>{const{name:i,value:a}=n.target;P(d=>({...d,[i]:a}))},F=n=>/^(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}$/.test(n),E=async n=>{n.preventDefault();const{currentPassword:i,newPassword:a,confirmPassword:d}=r;if(!i||!a||!d){e("All fields are required.");return}if(a!==d){e("New and confirm password do not match.");return}if(!F(a)){e("Password must be 8–20 characters, with at least one uppercase letter, one number, and one special character.");return}g(!0),e("");try{const l=await $.put(`${k}/updatePassword/${r.username}`,{password:i,newPassword:a,confirmPassword:d});l.data.success?(e("✅ Password updated successfully!"),P({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{j==null||j()},1e3)):e(l.data.message||"❌ Failed to update password.")}catch(l){console.error("Password update error:",l),e("❌ Error updating password.")}finally{g(!1)}};return s.jsx("div",{className:"container mt-4",children:s.jsx(A,{children:s.jsxs(B,{children:[s.jsx("h4",{className:"mb-3",children:"🔐 Change Password"}),s.jsxs(U,{onSubmit:E,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(w,{children:"User Name"}),s.jsxs(p,{children:[s.jsx(h,{type:"text",name:"username",value:r.username,onChange:c}),s.jsx(x,{onClick:()=>v(!o),style:{cursor:"pointer"},children:o?s.jsx(m,{}):s.jsx(u,{})})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(w,{children:"Current Password"}),s.jsxs(p,{children:[s.jsx(h,{type:o?"text":"password",name:"currentPassword",value:r.currentPassword,onChange:c}),s.jsx(x,{onClick:()=>v(!o),style:{cursor:"pointer"},children:o?s.jsx(m,{}):s.jsx(u,{})})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(w,{children:"New Password"}),s.jsxs(p,{children:[s.jsx(h,{type:f?"text":"password",name:"newPassword",value:r.newPassword,onChange:c,placeholder:"8–20 chars, 1 capital, 1 special, 1 number"}),s.jsx(x,{onClick:()=>N(!f),style:{cursor:"pointer"},children:f?s.jsx(m,{}):s.jsx(u,{})})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(w,{children:"Confirm New Password"}),s.jsxs(p,{children:[s.jsx(h,{type:C?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:c}),s.jsx(x,{onClick:()=>S(!C),style:{cursor:"pointer"},children:C?s.jsx(m,{}):s.jsx(u,{})})]})]}),y&&s.jsx("div",{className:"mb-3 text-danger fw-bold",children:y}),s.jsx(I,{type:"submit",color:"primary",disabled:b,children:b?"Updating...":"Update Password"})]})]})})})};export{_ as default};
